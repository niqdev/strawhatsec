<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Binary Exploitation / Memory Corruption | StrawHatSec</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://niqdev.github.io/strawhatsec/docs/notes/binary-exploitation-memory-corruption"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Binary Exploitation / Memory Corruption | StrawHatSec"><meta data-rh="true" name="description" content="Short ~10min videos about binary exploitation. From beginner to advanced"><meta data-rh="true" property="og:description" content="Short ~10min videos about binary exploitation. From beginner to advanced"><link data-rh="true" rel="icon" href="/strawhatsec/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://niqdev.github.io/strawhatsec/docs/notes/binary-exploitation-memory-corruption"><link data-rh="true" rel="alternate" href="https://niqdev.github.io/strawhatsec/docs/notes/binary-exploitation-memory-corruption" hreflang="en"><link data-rh="true" rel="alternate" href="https://niqdev.github.io/strawhatsec/docs/notes/binary-exploitation-memory-corruption" hreflang="x-default"><link rel="stylesheet" href="/strawhatsec/assets/css/styles.5628ff17.css">
<link rel="preload" href="/strawhatsec/assets/js/runtime~main.f41a3ca5.js" as="script">
<link rel="preload" href="/strawhatsec/assets/js/main.f0777602.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/strawhatsec/docs/home"><div class="navbar__logo"><img src="/strawhatsec/img/hat.png" alt="StrawHatSec Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/strawhatsec/img/hat.png" alt="StrawHatSec Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">StrawHatSec</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/niqdev/strawhatsec" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/strawhatsec/docs/home">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/strawhatsec/docs/resources/cryptography">Resources</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/strawhatsec/docs/notes/binary-exploitation-memory-corruption">Notes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/strawhatsec/docs/notes/binary-exploitation-memory-corruption">Binary Exploitation / Memory Corruption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/strawhatsec/docs/notes/the-art-of-petwork-penetration-testing">The Art of Network Penetration Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/strawhatsec/docs/notes/the-shellcoder-s-handbook">The Shellcoder&#x27;s Handbook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/strawhatsec/docs/notes/hacking-the-art-of-exploitation">Hacking: The Art of Exploitation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/strawhatsec/docs/htb/todo">HTB</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/strawhatsec/docs/docker/setup">Docker Images</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/strawhatsec/docs/contribute">How to contribute</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/strawhatsec/">ğŸ </a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Notes</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/strawhatsec/docs/notes/binary-exploitation-memory-corruption">Binary Exploitation / Memory Corruption</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Binary Exploitation / Memory Corruption</h1></header><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>About</h5></div><div class="admonition-content"><p>Short ~10min videos about binary exploitation. From beginner to advanced</p><p><a href="https://www.youtube.com/playlist?list=PLhixgUqwRTjxglIswKp9mpkfPNfHkzyeN" target="_blank" rel="noopener noreferrer">Binary Exploitation / Memory Corruption by LiveOverflow</a></p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="0x02">0x02<a class="hash-link" href="#0x02" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="notes">Notes<a class="hash-link" href="#notes" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm -it </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name ubuntu </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -v </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">pwd</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">/notes/liveoverflow/binary-exploitation-memory-corruption:/share&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --platform linux/386 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  i386/ubuntu:18.04 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># install C compiler and debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> update </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> gcc gdb -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">env</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">printenv</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">whereis</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:#36acaa">PATH</span><span class="token operator" style="color:#393A34">=</span><span class="token environment constant" style="color:#36acaa">$PATH</span><span class="token plain">:/share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> hello.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:set number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -Wall enables all warnings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc hello.c -o hello.out -Wall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello.out </span><span class="token string" style="color:#e3116c">&quot;liveoverflow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># prints exit code of previously running program</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ELF 32-bit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> hello.out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exiftool hello.out</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>See also <code>hexdump</code>, <code>xxd</code>, <code>od</code>, <code>hexcurse</code>, <code>hexyl</code></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="0x03">0x03<a class="hash-link" href="#0x03" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="notes-1">Notes<a class="hash-link" href="#notes-1" title="Direct link to heading">â€‹</a></h3><p>Vim</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> /share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># split 2 columns</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">vim</span><span class="token plain"> -O hello.c hello.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># change column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">double</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># skip words</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + LEFT/RIGHT ARROW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># jump at the beginning of the line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># jump at the end of the line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># create new line below cursor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># create new line above cursor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHIFT + o</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li><a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" target="_blank" rel="noopener noreferrer">Shebang</a></li></ul><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">python3 hello.py </span><span class="token string" style="color:#e3116c">&quot;liveoverflow&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># with shebang</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hello.py </span><span class="token string" style="color:#e3116c">&quot;liveoverflow&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="0x04">0x04<a class="hash-link" href="#0x04" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">â€‹</a></h3><ul><li><a href="https://microcorruption.com" target="_blank" rel="noopener noreferrer">Embedded Security CTF</a></li><li><a href="https://sockpuppet.org/issue-79-file-0xb-foxport-hht-hacking.txt.html" target="_blank" rel="noopener noreferrer">Issue 79, File 0xB</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="0x05">0x05<a class="hash-link" href="#0x05" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="notes-2">Notes<a class="hash-link" href="#notes-2" title="Direct link to heading">â€‹</a></h3><p>Debug</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> /share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># compile binary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -g -m32 -fno-stack-protector -z execstack -fno-pie -no-pie -Wall license.c -o license.out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">license.out AAAA-Z10N-42-OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># gnu debugger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gdb -q license.out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># every C program has a main function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># default AT&amp;T syntax</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># https://visualgdb.com/gdbreference/commands/set_disassembly-flavor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show disassembly-flavor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> disassembly-flavor intel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble main</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Analysis</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ 497 CMP == 2 â”‚ =2â”‚ 4ad PRINTF   â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ 49a JNE 4f6  â”œâ”€â”€â”€â–º 4c6 STRCMP   â”‚ returns 0 if equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ 4ce TEST EAX â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”‚               â”‚ 4d0 JNE 4e4  â”‚ zeroflag = 0 (strings different)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”‚not 2          â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”‚                 â”‚YES       â”‚NO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ 4f6      â”‚ â”‚ 4da PUTS    â”‚ â”‚ 4e4         â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ 4fe PUTS â”‚ â”‚ 4e2 JMP 506 â”‚ â”‚ 4ec PUTS    â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚ 4f4 JMP 506 â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”‚                 â”‚       â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â”‚            â”Œâ”€â”€â”€â”€â–¼â”         â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ 506 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                â””â”€â”€â”€â”€â”€â”˜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048486 &lt;+0&gt;:     lea    ecx,[esp+0x4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804848a &lt;+4&gt;:     and    esp,0xfffffff0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804848d &lt;+7&gt;:     push   DWORD PTR [ecx-0x4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048490 &lt;+10&gt;:    push   ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048491 &lt;+11&gt;:    mov    ebp,esp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048493 &lt;+13&gt;:    push   ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048494 &lt;+14&gt;:    push   ecx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048495 &lt;+15&gt;:    mov    ebx,ecx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # MAIN argc == 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048497 &lt;+17&gt;:    cmp    DWORD PTR [ebx],0x2          ; 497 CMP == 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804849a &lt;+20&gt;:    jne    0x80484f6 &lt;main+112&gt;         ; 49a JNE to 4f6 (#1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804849c &lt;+22&gt;:    mov    eax,DWORD PTR [ebx+0x4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804849f &lt;+25&gt;:    add    eax,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484a2 &lt;+28&gt;:    mov    eax,DWORD PTR [eax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484a4 &lt;+30&gt;:    sub    esp,0x8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484a7 &lt;+33&gt;:    push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484a8 &lt;+34&gt;:    push   0x80485a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # PRINT CHECKING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484ad &lt;+39&gt;:    call   0x8048330 &lt;printf@plt&gt;       ; 4ad PRINTF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484b2 &lt;+44&gt;:    add    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484b5 &lt;+47&gt;:    mov    eax,DWORD PTR [ebx+0x4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484b8 &lt;+50&gt;:    add    eax,0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484bb &lt;+53&gt;:    mov    eax,DWORD PTR [eax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484bd &lt;+55&gt;:    sub    esp,0x8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484c0 &lt;+58&gt;:    push   0x80485b6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484c5 &lt;+63&gt;:    push   eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # COMPARE LICENSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484c6 &lt;+64&gt;:    call   0x8048320 &lt;strcmp@plt&gt;       ; 4c6 STRCMP returns 0 if equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484cb &lt;+69&gt;:    add    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484ce &lt;+72&gt;:    test   eax,eax                      ; 4ce TEST EAX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484d0 &lt;+74&gt;:    jne    0x80484e4 &lt;main+94&gt;          ; 4d0 JNE to 4e4 (#2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484d2 &lt;+76&gt;:    sub    esp,0xc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484d5 &lt;+79&gt;:    push   0x80485c6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # PRINT WRONG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484da &lt;+84&gt;:    call   0x8048340 &lt;puts@plt&gt;         ; 4da PUTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484df &lt;+89&gt;:    add    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484e2 &lt;+92&gt;:    jmp    0x8048506 &lt;main+128&gt;         ; 4e2 JMP to 506 (#3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484e4 &lt;+94&gt;:    sub    esp,0xc                      ; 4e4 (#2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484e7 &lt;+97&gt;:    push   0x80485d6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # PRINT ACCESS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484ec &lt;+102&gt;:   call   0x8048340 &lt;puts@plt&gt;         ; 4ec PUTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484f1 &lt;+107&gt;:   add    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484f4 &lt;+110&gt;:   jmp    0x8048506 &lt;main+128&gt;         ; 4f4 JMP to 506 (#3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # PRINT USAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484f6 &lt;+112&gt;:   sub    esp,0xc                      ; 4f6 (#1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484f9 &lt;+115&gt;:   push   0x80485dd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x080484fe &lt;+120&gt;:   call   0x8048340 &lt;puts@plt&gt;         ; 4fe PUTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048503 &lt;+125&gt;:   add    esp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # EXIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048506 &lt;+128&gt;:   mov    eax,0x0                      ; 506 (#3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804850b &lt;+133&gt;:   lea    esp,[ebp-0x8]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804850e &lt;+136&gt;:   pop    ecx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0804850f &lt;+137&gt;:   pop    ebx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048510 &lt;+138&gt;:   pop    ebp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048511 &lt;+139&gt;:   lea    esp,[ecx-0x4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x08048514 &lt;+142&gt;:   ret    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End of assembler dump.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Crack manually</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># step through the program</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># step into next instruction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">si</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># step next instruction or ENTER</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">help</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># remove all breakpoints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">delete</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &gt;&gt;&gt; hack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># pass invalid key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run MY-KEY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># copy JUMP address of &quot;COMPARE LICENSE&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> *0x080484ce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># check EAX</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info registers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># override return value of STRCMP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$eax</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>TODO 0x06</p></blockquote><p>Reversing and Cracking first simple Program</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm --name reverse -p </span><span class="token number" style="color:#36acaa">5900</span><span class="token plain">:5900 -v </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">pwd</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">/liveoverflow:/share&quot;</span><span class="token plain"> strawhatsec/reverse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># vnc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vncviewer localhost:5900</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ghidra</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token builtin class-name">exec</span><span class="token plain"> -it reverse </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ghidra</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><hr><ul><li><a href="http://insecure.org/stf/smashstack.html" target="_blank" rel="noopener noreferrer">Smashing the Stack for Fun and Profit</a></li><li><a href="https://www.youtube.com/watch?v=qtoS3CG6ht0" target="_blank" rel="noopener noreferrer">GHIDRA HYPE!! - NSA Reverse Engineering Tool</a></li></ul><p>Challenges</p><ul><li><a href="https://crackmes.one/search" target="_blank" rel="noopener noreferrer">crackmes.one</a></li><li>archive mirror of <a href="http://crackmes.cf/archive" target="_blank" rel="noopener noreferrer">crackmes.de</a></li><li><a href="https://exploit.education" target="_blank" rel="noopener noreferrer">exploit.education</a><ul><li><a href="https://github.com/eLoopWoo/exploit-education-solutions" target="_blank" rel="noopener noreferrer">exploit-education-solutions</a></li></ul></li><li><a href="https://www.vulnhub.com" target="_blank" rel="noopener noreferrer">VulnHub</a> <strong>TODO</strong> on DigitalOcean with Vagrant - no network access</li></ul><p>Kernel</p><ul><li><a href="https://software.intel.com/content/www/us/en/develop/articles/intel-sdm.html" target="_blank" rel="noopener noreferrer">Intel 64 and IA-32 Architectures Software Developer Manuals</a>: OPCODE vs SYSCALL<ul><li><a href="https://www.intel.de/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-instruction-set-reference-manual-325383.pdf" target="_blank" rel="noopener noreferrer">Instruction set reference</a></li></ul></li><li>search <a href="https://elixir.bootlin.com/linux/latest/ident" target="_blank" rel="noopener noreferrer">kernel</a></li><li><a href="https://filippo.io/linux-syscall-table" target="_blank" rel="noopener noreferrer">Searchable Linux Syscall Table for x86 and x86_64</a></li><li><a href="https://www.kernel.org/doc/html/latest/x86/exception-tables.html" target="_blank" rel="noopener noreferrer">Example C to Assembler</a></li><li><a href="https://gist.github.com/rkubik/b96c23bd8ed58333de37f2b8cd052c30" target="_blank" rel="noopener noreferrer">GDB cheat sheet</a></li></ul><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">file</span><span class="token plain"> hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hexdump hello -C</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>RIP: instrution pointer</li></ul><p>Output</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Dump of assembler code for function main:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001215 &lt;+0&gt;: push   rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001216 &lt;+1&gt;: mov    rbp,rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # MAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # from output &quot;break main&quot;: (gdb) break main, Breakpoint 1 at 0x1219</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001219 &lt;+4&gt;: sub    rsp,0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000121d &lt;+8&gt;: mov    DWORD PTR [rbp-0x4],edi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001220 &lt;+11&gt;:    mov    QWORD PTR [rbp-0x10],rsi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # argc == 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001224 &lt;+15&gt;:    cmp    DWORD PTR [rbp-0x4],0x2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (1a)(1b) JUMP NOT EQUAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001228 &lt;+19&gt;:    jne    0x1283 &lt;main+110&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000122a &lt;+21&gt;:    mov    rax,QWORD PTR [rbp-0x10]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000122e &lt;+25&gt;:    add    rax,0x8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001232 &lt;+29&gt;:    mov    rax,QWORD PTR [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001235 &lt;+32&gt;:    mov    rsi,rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001238 &lt;+35&gt;:    lea    rdi,[rip+0xdc1]        # 0x2000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000123f &lt;+42&gt;:    mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (2b) PRINTF CHECKING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001244 &lt;+47&gt;:    call   0x1020 &lt;printf@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001249 &lt;+52&gt;:    mov    rax,QWORD PTR [rbp-0x10]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000124d &lt;+56&gt;:    add    rax,0x8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001251 &lt;+60&gt;:    mov    rax,QWORD PTR [rax]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001254 &lt;+63&gt;:    lea    rsi,[rip+0xdbb]        # 0x2016</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000125b &lt;+70&gt;:    mov    rdi,rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (3b)(1c) STRCMP return 0 if equal: man strcmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000125e &lt;+73&gt;:    call   0x1040 &lt;strcmp@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # BREAK POINT HERE &lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001263 &lt;+78&gt;:    test   eax,eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (4b)(2c) JUMP NOT EQUAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001265 &lt;+80&gt;:    jne    0x1275 &lt;main+96&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001267 &lt;+82&gt;:    lea    rdi,[rip+0xdb8]        # 0x2026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (5b) PRINTF ACCESS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000126e &lt;+89&gt;:    call   0x1030 &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001273 &lt;+94&gt;:    jmp    0x128f &lt;main+122&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001275 &lt;+96&gt;:    lea    rdi,[rip+0xdba]        # 0x2036</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (3c) PRINTF WRONG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000127c &lt;+103&gt;:   call   0x1030 &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001281 &lt;+108&gt;:   jmp    0x128f &lt;main+122&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (2a) PRINTF USAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001283 &lt;+110&gt;:   lea    rdi,[rip+0xdb3]        # 0x203d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000128a &lt;+117&gt;:   call   0x1030 &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   # (3a)(6b)(4c) EXIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x000000000000128f &lt;+122&gt;:   mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001294 &lt;+127&gt;:   leave  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0x0000000000001295 &lt;+128&gt;:   ret    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End of assembler dump.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ascii defines only from 0 to 7F</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 0x7F (0111 1111) = 127 chars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 0xFF (1111 1111) = 255</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1 byte goes from 0x00 to 0xFF (0-255)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - every chars has an assigned number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># - there are numbers that don&#x27;t have a printable number assigned (weird values in VIM when opening a binary)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">man</span><span class="token plain"> ascii</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># all printable chars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings /share/license</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># non-printable chars</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hexdump -C /share/license</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># disassembly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">objdump -d /share/license</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">man</span><span class="token plain"> syscall</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">man</span><span class="token plain"> syscalls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># trace system calls and signals</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">strace</span><span class="token plain"> ./license</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ltrace ./license</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Output</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">strace ./license AAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execve(&quot;./license&quot;, [&quot;./license&quot;, &quot;AAA&quot;], 0x7ffe79b59438 /* 74 vars */) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brk(NULL)                               = 0x558a8cae4000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arch_prctl(0x3001 /* ARCH_??? */, 0x7fff9fa89ad0) = -1 EINVAL (Invalid argument)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openat(AT_FDCWD, &quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fstat(3, {st_mode=S_IFREG|0644, st_size=84800, ...}) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(NULL, 84800, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f5d84687000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(3)                                = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libc.so.6&quot;, O_RDONLY|O_CLOEXEC) = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">read(3, &quot;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\360q\2\0\0\0\0\0&quot;..., 832) = 832</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0&quot;..., 784, 64) = 784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0&quot;, 32, 848) = 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\t\233\222%\274\260\320\31\331\326\10\204\276X&gt;\263&quot;..., 68, 880) = 68</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fstat(3, {st_mode=S_IFREG|0755, st_size=2029224, ...}) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f5d84685000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0&quot;..., 784, 64) = 784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0&quot;, 32, 848) = 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pread64(3, &quot;\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\t\233\222%\274\260\320\31\331\326\10\204\276X&gt;\263&quot;..., 68, 880) = 68</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(NULL, 2036952, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5d84493000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x7f5d844b8000, 1847296, PROT_NONE) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(0x7f5d844b8000, 1540096, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x25000) = 0x7f5d844b8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(0x7f5d84630000, 303104, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x19d000) = 0x7f5d84630000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(0x7f5d8467b000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x1e7000) = 0x7f5d8467b000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mmap(0x7f5d84681000, 13528, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f5d84681000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">close(3)                                = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">arch_prctl(ARCH_SET_FS, 0x7f5d84686540) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x7f5d8467b000, 12288, PROT_READ) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x558a8c9bb000, 4096, PROT_READ) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mprotect(0x7f5d846c9000, 4096, PROT_READ) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">munmap(0x7f5d84687000, 84800)           = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(0x88, 0), ...}) = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brk(NULL)                               = 0x558a8cae4000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brk(0x558a8cb05000)                     = 0x558a8cb05000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(1, &quot;Checking License: AAA\n&quot;, 22Checking License: AAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">) = 22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">write(1, &quot;WRONG!\n&quot;, 7WRONG!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)                 = 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exit_group(0)                           = ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+++ exited with 0 +++</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Radare</p><blockquote><p>TODO review 0x06</p></blockquote><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">r2 license</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aaa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s sys.main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pdf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">V!</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Parser differential: program compiles but gdb and radare2 can&#x27;t</p><p><a href="https://www.sentinelone.com/blog/breaking-and-evading" target="_blank" rel="noopener noreferrer">https://www.sentinelone.com/blog/breaking-and-evading</a>
<a href="https://ioactive.com/striking-back-gdb-and-ida-debuggers-through-malformed-elf-executables/" target="_blank" rel="noopener noreferrer">https://ioactive.com/striking-back-gdb-and-ida-debuggers-through-malformed-elf-executables/</a></p><p>Conversions</p><ul><li>Binary Data Structures <a href="https://pymotw.com/3/struct" target="_blank" rel="noopener noreferrer">struct</a></li><li><a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener noreferrer">Endianness</a></li><li><a href="https://en.wikipedia.org/wiki/Two%27s_complement" target="_blank" rel="noopener noreferrer">Two&#x27;s complement</a></li></ul><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># binary to decimal</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;1111&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;00000000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;00000010&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;01010101&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;11110010&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;11111111&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;{0} | {1:3} | {2:2x}&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#00000000 |   0 |  0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#00000010 |   2 |  2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#01010101 |  85 | 55</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#11110010 | 242 | f2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#11111111 | 255 | ff</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">bin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;0b1111011&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;0x7b&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;0b1111011&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&#x27;0x7b&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># I = unsigned integer</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><code>setuid</code> and <code>setgid</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">The Unix access rights flags setuid and setgid (short for &quot;set user ID&quot; and &quot;set group ID&quot;) allow users to run an executable with the file system permissions of the executable&#x27;s owner or group respectively and to change behaviour in directories. They are often used to allow users on a computer system to run programs with temporarily elevated privileges in order to perform a specific task.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># example: see `s`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ll /usr/bin/passwd </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Permissions Size User Date Modified Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.rwsr-xr-x   68k root 28 May  2020  /usr/bin/passwd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>0x0C <a href="https://youtu.be/T03idxny9jE" target="_blank" rel="noopener noreferrer">video</a></li><li><a href="https://exploit.education/protostar/stack-zero" target="_blank" rel="noopener noreferrer">stack0</a></li></ul><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gdb stack0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">set</span><span class="token plain"> disassembly-flavor intel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disassemble main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info registers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># map memory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">info proc mappings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mapped address spaces:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          Start Addr           End Addr       Size     Offset objfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      0x7fffd94cc000     0x7fffd94ed000    0x21000        0x0 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">stack</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># stack is bottom-up</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># register $ESP points to the top of the stack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ends to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x7fffd94cc000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># starts from (bottom)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x7fffd94ed000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># inspect address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/wx </span><span class="token variable" style="color:#36acaa">$esp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">define hook-stop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># print</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 -c </span><span class="token string" style="color:#e3116c">&#x27;print(&quot;A&quot;*64)&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># &gt;&gt;&gt; ENTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># register RBP contains ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001215 &lt;+0&gt;:    push   rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001216 &lt;+1&gt;:    mov    rbp,rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># mask RSP to keep it nicely aligned ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001219 &lt;+4&gt;:    sub    rsp,0x70</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000121d &lt;+8&gt;:    mov    DWORD PTR [rbp-0x64],edi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001220 &lt;+11&gt;:   mov    QWORD PTR [rbp-0x70],rsi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001224 &lt;+15&gt;:   mov    rax,QWORD PTR fs:0x28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000122d &lt;+24&gt;:   mov    QWORD PTR [rbp-0x8],rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001231 &lt;+28&gt;:   xor    eax,eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001233 &lt;+30&gt;:   mov    DWORD PTR [rbp-0x54],0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000123a &lt;+37&gt;:   lea    rax,[rbp-0x50]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000123e &lt;+41&gt;:   mov    rdi,rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001241 &lt;+44&gt;:   mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001246 &lt;+49&gt;:   call   0x1020 &lt;gets@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000124b &lt;+54&gt;:   mov    eax,DWORD PTR [rbp-0x54]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000124e &lt;+57&gt;:   test   eax,eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001250 &lt;+59&gt;:   je     0x1260 &lt;main+75&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001252 &lt;+61&gt;:   lea    rdi,[rip+0xda7]        # 0x2000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001259 &lt;+68&gt;:   call   0x1030 &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000125e &lt;+73&gt;:   jmp    0x126c &lt;main+87&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001260 &lt;+75&gt;:   lea    rdi,[rip+0xdc2]        # 0x2029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001267 &lt;+82&gt;:   call   0x1030 &lt;puts@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000126c &lt;+87&gt;:   mov    eax,0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001271 &lt;+92&gt;:   mov    rdx,QWORD PTR [rbp-0x8]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001275 &lt;+96&gt;:   sub    rdx,QWORD PTR fs:0x28</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x000000000000127e &lt;+105&gt;:  je     0x1285 &lt;main+112&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001280 &lt;+107&gt;:  call   0x1040 &lt;__stack_chk_fail@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># &lt;&lt;&lt; EXIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># LEAVEâ€”High Level Procedure Exit: Set RSP to RBP, then pop RBP.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Releases the stack frame set up by an earlier ENTER instruction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The LEAVE instruction copies the frame pointer (in the EBP register) into the stack pointer register (ESP),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># which releases the stack space allocated to the stack frame.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001285 &lt;+112&gt;:  leave  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0000000000001286 &lt;+113&gt;:  ret</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># instruction pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EIP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># stack pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ESP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># base pointer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EBP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># push address after EIP on the stack, then jump to main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># LEA: load effective address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># similar to MOV, instead of moving the content of a register offset into a register,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># it moves the address of register offset into a register </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>1) before enter main we push address of NEXT function on the stack
2) enter main and we have 2 pointer:</p><ul><li>EBP is at the bottom of the stack frame</li><li>ESP is at the top of the stack frame</li><li>MOV + SUB create space between botto and top</li><li><blockquote><blockquote><blockquote><p>internal variable are added from the bottom</p></blockquote></blockquote></blockquote></li><li><blockquote><blockquote><blockquote><p>parameter are added from the top</p></blockquote></blockquote></blockquote></li></ul><p><a href="https://github.com/NationalSecurityAgency/ghidra/issues/1495" target="_blank" rel="noopener noreferrer">https://github.com/NationalSecurityAgency/ghidra/issues/1495</a>
<a href="https://github.com/ProtonVPN/linux-cli/issues/297" target="_blank" rel="noopener noreferrer">https://github.com/ProtonVPN/linux-cli/issues/297</a></p><blockquote><p>TODO 9.10</p></blockquote><p><a href="https://exploit.education/downloads/" target="_blank" rel="noopener noreferrer">https://exploit.education/downloads/</a></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/strawhatsec/docs/resources/shellcode"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Shellcode</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/strawhatsec/docs/notes/the-art-of-petwork-penetration-testing"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The Art of Network Penetration Testing</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#0x02" class="table-of-contents__link toc-highlight">0x02</a><ul><li><a href="#notes" class="table-of-contents__link toc-highlight">Notes</a></li></ul></li><li><a href="#0x03" class="table-of-contents__link toc-highlight">0x03</a><ul><li><a href="#notes-1" class="table-of-contents__link toc-highlight">Notes</a></li></ul></li><li><a href="#0x04" class="table-of-contents__link toc-highlight">0x04</a><ul><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></li><li><a href="#0x05" class="table-of-contents__link toc-highlight">0x05</a><ul><li><a href="#notes-2" class="table-of-contents__link toc-highlight">Notes</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/strawhatsec/docs/contribute">Contribute</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 niqdev</div></div></div></footer></div>
<script src="/strawhatsec/assets/js/runtime~main.f41a3ca5.js"></script>
<script src="/strawhatsec/assets/js/main.f0777602.js"></script>
</body>
</html>