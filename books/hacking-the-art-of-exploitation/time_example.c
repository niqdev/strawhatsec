#include <stdio.h>
#include <time.h>

// gcc -g time_example.c -o time_example.out
int main() {
  long int seconds_since_epoch;
  struct tm current_time, *time_ptr;
  int hour, minute, second, day, month, year;

  seconds_since_epoch = time(0); // Pass time a null pointer as argument.
  printf("time() - seconds since epoch: %ld\n", seconds_since_epoch);

  time_ptr = &current_time; // Set time_ptr to the address of the current_time struct.
  localtime_r(&seconds_since_epoch, time_ptr);

  // Three different ways to access struct elements:
  hour = current_time.tm_hour; // Direct access
  minute = time_ptr->tm_min; // Access via pointer
  second = *((int *) time_ptr); // Hacky pointer access

  printf("Current time is: %02d:%02d:%02d\n", hour, minute, second);
}

/*

cat /usr/include/time.h

- structs are variables that can contain many other variables
- the `time()` function will return the number of seconds since January 1, 1970
- time on Unix systems is kept relative to this rather arbitrary point in time, which is also known as the epoch

struct tm {
  int tm_sec;
  int tm_min;
  int tm_hour;
  int tm_mday;  // day of the month
  int tm_mon;
  int tm_year;
  int tm_wday;  // day of the week
  int tm_yday;  // day in the year
  int tm_isdst; // daylight saving time
};

about second
- remember that in the end, it's all just memory
- Since `tm_sec` is defined at the beginning of the tm struct, that integer value is also found at the beginning.
  In the line `second = *((int *) time_ptr)`, the variable `time_ptr` is typecast
  from a `tm` struct pointer to an integer pointer.
  Then this typecast pointer is dereferenced, returning the data at the pointer's address.
  Since the address to the `tm` struct also points to the first element of this struct,
  this will retrieve the integer value for `tm_sec` in the struct.

OUTPUT

./time_example.out 
time() - seconds since epoch: 1645199082
Current time is: 15:44:42

*/
