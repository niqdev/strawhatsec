#include <stdio.h>
#include <stdlib.h>

// gcc -g fmt_uncommon.c -o fmt_uncommon.out
int main() {
  int A = 5, B = 7, count_one, count_two;

  // Example of a %n format string
  printf("The number of bytes written up to this point X%n is being stored in count_one, and the number of bytes up to here X%n is being stored in count_two.\n", &count_one, &count_two);

  printf("count_one: %d\n", count_one);
  printf("count_two: %d\n", count_two);

  // Stack example
  printf("A is %d and is at %08x. B is %x.\n", A, &A, B);

  exit(0);
}

/*

Parameter | Input Type  | Output Type
%d          Value         Decimal
%u          Value         Unsigned decimal
%x          Value         Hexadecimal
%s          Pointer       String
%n          Pointer       Number of bytes written so far  // <<<

The %n format parameter is unique in that it writes data without displaying anything, as opposed to reading and then displaying data.
When a format function encounters a %n format parameter, it writes the number of bytes that have been written by the function to the address in the corresponding function argument.

When this printf() function is called (as with any function), the arguments are pushed to the stack in reverse order.
First the value of B, then the address of A, then the value of A, and finally the address of the format string.

# 4 arguments
printf("A is %d and is at %08x. B is %x.\n", A, &A, B);

(Top of the Stack)
Address of format string
Value of A
Address of A
Value of B
(Bottom of the Stack)

OUTPUT

./fmt_uncommon.out 
The number of bytes written up to this point X is being stored in count_one, and the number of bytes up to here X is being stored in count_two.
count_one: 46
count_two: 113
A is 5 and is at ffdc79ec. B is 7.

##############################

# remove last argument of printf
printf("A is %d and is at %08x. B is %x.\n", A, &A);

./fmt_uncommon.out 
The number of bytes written up to this point X is being stored in count_one, and the number of bytes up to here X is being stored in count_two.
count_one: 46
count_two: 113
A is 5 and is at ffc9f07c. B is 56607564.

*/
