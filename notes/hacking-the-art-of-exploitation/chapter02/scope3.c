#include <stdio.h>

int j = 42; // j is a global variable.

void func3() {
  int i = 11, j = 999; // Here, j is a local variable of func3().
  printf("\t\t\t[in func3] i @ 0x%08x = %d\n", &i, i);
  printf("\t\t\t[in func3] j @ 0x%08x = %d\n", &j, j);
}

void func2() {
  int i = 7;
  printf("\t\t[in func2] i @ 0x%08x = %d\n", &i, i);
  printf("\t\t[in func2] j @ 0x%08x = %d\n", &j, j);
  printf("\t\t[in func2] setting j = 1337\n");
  j = 1337; // Writing to j
  func3();
  printf("\t\t[back in func2] i @ 0x%08x = %d\n", &i, i);
  printf("\t\t[back in func2] j @ 0x%08x = %d\n", &j, j);
}

void func1() {
  int i = 5;
  printf("\t[in func1] i @ 0x%08x = %d\n", &i, i);
  printf("\t[in func1] j @ 0x%08x = %d\n", &j, j);
  func2();
  printf("\t[back in func1] i @ 0x%08x = %d\n", &i, i);
  printf("\t[back in func1] j @ 0x%08x = %d\n", &j, j);
}

// gcc -g scope3.c -o scope3.out
int main() {
  int i = 3;
  printf("[in main] i @ 0x%08x = %d\n", &i, i);
  printf("[in main] j @ 0x%08x = %d\n", &j, j);
  func1();
  printf("[back in main] i @ 0x%08x = %d\n", &i, i);
  printf("[back in main] j @ 0x%08x = %d\n", &j, j);
}

/*
# use -g flag: compyle with symbols
(gdb) list
(gdb) break 7
(gdb) run
(gdb) bt
#0  func3 () at scope3.c:7
#1  0x5657d6a2 in func2 () at scope3.c:17
#2  0x5657d756 in func1 () at scope3.c:26
#3  0x5657d815 in main () at scope3.c:36
^^^ each line in the backtrace corresponds to a stack frame
# show variables contained in each stack frame
(gdb) bt full
#0  func3 () at scope3.c:7
  i = 11
  j = 999
#1  0x5657d6a2 in func2 () at scope3.c:17
  i = 7
#2  0x5657d756 in func1 () at scope3.c:26
  i = 5
#3  0x5657d815 in main () at scope3.c:36
  i = 3

OUTPUT

[in main] i @ 0xff9628e8 = 3
[in main] j @ 0x565d2008 = 42
	[in func1] i @ 0xff9628c8 = 5
	[in func1] j @ 0x565d2008 = 42
		[in func2] i @ 0xff9628a8 = 7
		[in func2] j @ 0x565d2008 = 42
		[in func2] setting j = 1337
			[in func3] i @ 0xff962884 = 11
			[in func3] j @ 0xff962888 = 999
		[back in func2] i @ 0xff9628a8 = 7
		[back in func2] j @ 0x565d2008 = 1337
	[back in func1] i @ 0xff9628c8 = 5
	[back in func1] j @ 0x565d2008 = 1337
[back in main] i @ 0xff9628e8 = 3
[back in main] j @ 0x565d2008 = 1337
*/
